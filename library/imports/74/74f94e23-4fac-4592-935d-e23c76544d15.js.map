{"version":3,"sources":["../../../../assets/Script/assets/Script/Help.js"],"names":["NetData","require","Game","cc","Class","extends","Component","properties","uiBlack","Node","testNode","scrollView","content","view","lock","gameNode","imgArray","Sprite","scaleValue","showCallBack","onLoad","size","director","getWinSize","ssss","width","height","netData","getInst","oriP1","convertToWorldSpaceAR","v2","oriY","y","callFunc_1","callFunc","se","getChildByName","node","runAction","sequence","delayTime","on","EventType","TOUCH_START","event","stopPropagation","close","errorCallBack","closeCallback","closeType","active","call3","helpShowFlag","window","aliLotteryCasinoSDK","throwTimer","moveTo","downHelp","GameRule","log","self","spt","getComponent","rh","res","helpRule","rulePics","loader","load","errors","results","i","length","console","getError","getContent","len","aTex","sf","SpriteFrame","setTexture","spriteFrame","heightT","index","ht","hideWait","initHelp","ScrollView","scrollToOffset","p","callback","selectShowCallBack"],"mappings":";;;;;;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,OAAOD,QAAQ,MAAR,CAAX;;AAEAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,iBAAUL,GAAGM,IAFL;AAGRC,kBAAWP,GAAGM,IAHN;AAIRE,oBAAYR,GAAGM,IAJP;AAKRG,iBAAST,GAAGM,IALJ;AAMRI,cAAMV,GAAGM,IAND;AAORK,cAAO,KAPC;AAQRC,kBAAUZ,GAAGM,IARL;AASRO,kBAAW,CAACb,GAAGc,MAAJ,CATH;AAURC,oBAAW,CAVH;AAWRC,sBAAa;AAXL,KAHP;;AAiBL;AACAC,YAAQ,kBAAY;AAChB,YAAIC,OAAOlB,GAAGmB,QAAH,CAAYC,UAAZ,EAAX;AACA,YAAIC,OAASH,KAAKI,KAAL,GAAa,IAAd,IAAuB,OAAOJ,KAAKK,MAAnC,CAAZ;AACA,aAAKR,UAAL,GAAkBM,IAAlB;AACA,aAAKG,OAAL,GAAe3B,QAAQA,OAAR,CAAgB4B,OAAhB,EAAf;AACA,aAAKd,IAAL,GAAY,IAAZ;AACA,YAAIe,QAAQ,KAAKnB,QAAL,CAAcoB,qBAAd,CAAoC3B,GAAG4B,EAAH,CAAM,CAAN,EAAS,CAAT,CAApC,CAAZ;AACA,aAAKC,IAAL,GAAY,KAAKtB,QAAL,CAAcuB,CAAd,GAAkBJ,MAAMI,CAApC;AACA,YAAIC,aAAa/B,GAAGgC,QAAH,CAAY,YAC7B;AACI,iBAAKrB,IAAL,GAAY,KAAZ;AACA,gBAAIsB,KAAKjC,GAAGmB,QAAH,CAAYC,UAAZ,EAAT;AACA,iBAAKZ,UAAL,CAAgBe,MAAhB,GAAyBU,GAAGV,MAAH,GAAY,GAArC;AACA,iBAAKf,UAAL,CAAgB0B,cAAhB,CAA+B,MAA/B,EAAuCX,MAAvC,GAAgD,KAAKf,UAAL,CAAgBe,MAAhE;AACA,iBAAKY,IAAL,CAAUZ,MAAV,GAAmB,KAAKf,UAAL,CAAgBe,MAAnC;AACA,iBAAKY,IAAL,CAAUL,CAAV,GAAc,KAAKD,IAAL,GAAY,KAAKrB,UAAL,CAAgBe,MAA1C;AACA;AACH,SATgB,EASd,IATc,CAAjB;;AAWA,aAAKY,IAAL,CAAUC,SAAV,CAAoBpC,GAAGqC,QAAH,CAAYrC,GAAGsC,SAAH,CAAa,GAAb,CAAZ,EAA+BP,UAA/B,CAApB;;AAEA,aAAK1B,OAAL,CAAakC,EAAb,CAAgBvC,GAAGM,IAAH,CAAQkC,SAAR,CAAkBC,WAAlC,EAA+C,UAAUC,KAAV,EAAgB;AAC3DA,kBAAMC,eAAN;AACA,iBAAKC,KAAL,CAAW,IAAX,EAAiB,CAAjB;AACH,SAHD,EAGG,IAHH;AAIH,KA3CI;;AA6CLC,mBAAc,yBAAU;AACpB,YAAG,KAAK7B,YAAR,EACA;AACK,iBAAKA,YAAN,IAAwB,KAAKA,YAAN,CAAoB,IAApB,CAAvB;AACA,iBAAKA,YAAL,GAAoB,IAApB;AACH;AACJ,KAnDI;;AAqDL4B,WAAO,eAASE,aAAT,EAAwBC,SAAxB,EAAkC;AACrC,YAAG,CAAC,KAAKpC,IAAT,EAAc;AACV,iBAAKN,OAAL,CAAa2C,MAAb,GAAsB,KAAtB;AACA,gBAAIC,QAAQjD,GAAGgC,QAAH,CAAY,YACxB;AACI,qBAAKR,OAAL,CAAa0B,YAAb,GAA4B,KAA5B;AACA,oBAAGH,aAAa,CAAhB,EACA;AACI,wBAAGI,OAAOC,mBAAV,EACA;AACID,+BAAOC,mBAAP,CAA2BC,UAA3B,CAAsC,WAAtC,EAAmD,MAAnD;AACH;AAEJ,iBAPD,MAQK,IAAGN,aAAY,CAAf,EACL;AACID,qCAAiBA,eAAjB;AACH;AACJ,aAfW,EAeT,IAfS,CAAZ;;AAiBA,iBAAKX,IAAL,CAAUC,SAAV,CAAoBpC,GAAGqC,QAAH,CAAYrC,GAAGsD,MAAH,CAAU,GAAV,EAAetD,GAAG4B,EAAH,CAAM,CAAN,EAAS,KAAKC,IAAL,GAAY,KAAKrB,UAAL,CAAgBe,MAArC,CAAf,CAAZ,EAA0E0B,KAA1E,CAApB;AACH;AACJ,KA3EI;;AA6ELM,cAAU,oBAAU;AAChB,YAAG1D,QAAQA,OAAR,CAAgB4B,OAAhB,GAA0B+B,QAA1B,IAAsC,IAAzC,EAA8C;AAC1CxD,eAAGyD,GAAH,CAAO,mBAAP;AACA;AACH;AACD,YAAIC,OAAO,IAAX;AACA,YAAIC,MAAM,KAAK/C,QAAL,CAAcgD,YAAd,CAA2B7D,IAA3B,CAAV;AACA,YAAI8D,KAAK,CAAT;AACA,YAAIC,MAAM,KAAKtC,OAAL,CAAagC,QAAb,CAAsBO,QAAtB,CAA+BC,QAAzC;AACAhE,WAAGiE,MAAH,CAAUC,IAAV,CAAeJ,GAAf,EAAoB,IAApB,EAA0B,UAAUK,MAAV,EAAkBC,OAAlB,EAA2B;AACjD,gBAAID,MAAJ,EAAY;AACR,qBAAK,IAAIE,IAAI,CAAb,EAAgBA,IAAIF,OAAOG,MAA3B,EAAmCD,GAAnC,EAAwC;AACpCE,4BAAQd,GAAR,CAAY,gBAAgBU,OAAOE,CAAP,CAAhB,GAA4B,KAA5B,GAAoCD,QAAQI,QAAR,CAAiBL,OAAOE,CAAP,CAAjB,CAAhD;AACH;AACJ;AACDrE,eAAGyD,GAAH,CAAO,gBAAP,EAAyBW,QAAQK,UAAR,CAAmBH,MAA5C;AACA,gBAAII,MAAMhB,KAAKlC,OAAL,CAAagC,QAAb,CAAsBO,QAAtB,CAA+BC,QAA/B,CAAwCM,MAAlD;;AAEA,iBAAI,IAAID,KAAI,CAAZ,EAAeA,KAAIK,GAAnB,EAAwBL,IAAxB,EAA4B;;AAExB,oBAAIM,OAAOP,QAAQK,UAAR,CAAmBf,KAAKlC,OAAL,CAAagC,QAAb,CAAsBO,QAAtB,CAA+BC,QAA/B,CAAwCK,EAAxC,CAAnB,CAAX;AACAE,wBAAQd,GAAR,CAAYC,KAAKlC,OAAL,CAAagC,QAAb,CAAsBO,QAAtB,CAA+BC,QAA/B,CAAwCK,EAAxC,IAA6C,GAA7C,GAAmDM,IAA/D;AACA,oBAAIC,KAAK,IAAI5E,GAAG6E,WAAP,EAAT;AACAD,mBAAGE,UAAH,CAAcH,IAAd;AACAjB,qBAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBa,MAAtB,GAA+B,IAA/B;AACAU,qBAAK7C,QAAL,CAAcwD,EAAd,EAAiBU,WAAjB,GAA+BH,EAA/B;AACA;AACA,oBAAItD,QAAQoC,KAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBb,KAAlC;AACA,oBAAI0D,UAAW,OAAO1D,KAAR,GAAiBoC,KAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBZ,MAAvC,GAAgDmC,KAAK3C,UAAnE;AACA2C,qBAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBb,KAAtB,GAA8B,OAAOoC,KAAK3C,UAA1C;AACA2C,qBAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBZ,MAAtB,GAA+ByD,OAA/B;AACA;AACAnB,sBAAMmB,OAAN;AACAhF,mBAAGyD,GAAH,CAAO,gBAAP,EAAyBC,KAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBZ,MAA/C;AACA;AACA,oBAAG8C,KAAI,CAAP,EAAS;;AAEL,wBAAIY,QAAQZ,KAAI,CAAhB;AACA,wBAAIa,KAAKxB,KAAK7C,QAAL,CAAcoE,KAAd,EAAqB9C,IAArB,CAA0BZ,MAAnC;AACAmC,yBAAK7C,QAAL,CAAcwD,EAAd,EAAiBlC,IAAjB,CAAsBL,CAAtB,GAA2B4B,KAAK7C,QAAL,CAAcoE,KAAd,EAAqB9C,IAArB,CAA0BL,CAA1B,GAA8BoD,EAA9B,GAAmC,CAA9D;AACA;AACH;AACJ;;AAED;AACA;AACA;AACA;AACAxB,iBAAKjD,OAAL,CAAac,MAAb,GAAsBsC,EAAtB;AACAF,gBAAIwB,QAAJ;AACAzB,iBAAK0B,QAAL;AACH,SA1CD;AA2CH,KAjII;;AAmILA,cAAS,oBAAW;AAChB,YAAG,CAAC,KAAKzE,IAAT,EAAc;AACV4D,oBAAQd,GAAR,CAAY,UAAZ;AACA,iBAAKjC,OAAL,CAAa0B,YAAb,GAA4B,IAA5B;AACA,iBAAKvC,IAAL,GAAY,IAAZ;AACA,iBAAKH,UAAL,CAAgBoD,YAAhB,CAA6B5D,GAAGqF,UAAhC,EAA4CC,cAA5C,CAA2DtF,GAAGuF,CAAH,CAAK,CAAL,EAAO,CAAP,CAA3D,EAAsE,GAAtE;AACA,gBAAIC,WAAWxF,GAAGgC,QAAH,CAAY,KAAKyD,kBAAjB,EAAqC,IAArC,CAAf;AACA,iBAAKtD,IAAL,CAAUC,SAAV,CAAoBpC,GAAGqC,QAAH,CAAYrC,GAAGsD,MAAH,CAAU,GAAV,EAAetD,GAAGuF,CAAH,CAAK,CAAL,EAAQ,KAAK1D,IAAb,CAAf,CAAZ,EAAgD2D,QAAhD,CAApB;AACH;AACJ,KA5II;;AA8ILC,wBAAmB,8BACnB;AACI,aAAKpF,OAAL,CAAa2C,MAAb,GAAsB,IAAtB;AACA,aAAKrC,IAAL,GAAY,KAAZ;;AAEA,YAAG,KAAKK,YAAR,EACA;AACK,iBAAKA,YAAN,IAAwB,KAAKA,YAAN,EAAvB;;AAEA,iBAAKA,YAAL,GAAoB,IAApB;AACH;AACJ;;AAzJI,CAAT","file":"Help.js","sourceRoot":"../../../../assets/Script","sourcesContent":["var NetData = require(\"NetData\");\nvar Game = require(\"Game\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //游戏帮助\n        uiBlack : cc.Node,\n        testNode : cc.Node,\n        scrollView: cc.Node,\n        content: cc.Node,\n        view: cc.Node,\n        lock : false,\n        gameNode: cc.Node,\n        imgArray : [cc.Sprite],\n        scaleValue:1,\n        showCallBack:null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        let size = cc.director.getWinSize();\n        let ssss =  (size.width * 1660)  /(1080 * size.height);\n        this.scaleValue = ssss;\n        this.netData = NetData.NetData.getInst();\n        this.lock = true;\n        let oriP1 = this.testNode.convertToWorldSpaceAR(cc.v2(0, 0));\n        this.oriY = this.testNode.y - oriP1.y;     \n        var callFunc_1 = cc.callFunc(function()\n        {\n            this.lock = false;\n            var se = cc.director.getWinSize();\n            this.scrollView.height = se.height * 0.8;\n            this.scrollView.getChildByName(\"view\").height = this.scrollView.height;\n            this.node.height = this.scrollView.height;\n            this.node.y = this.oriY - this.scrollView.height;    \n            //console.log(\"ny=\" + this.node.y);\n        }, this);\n\n        this.node.runAction(cc.sequence(cc.delayTime(0.1), callFunc_1));\n\n        this.uiBlack.on(cc.Node.EventType.TOUCH_START, function (event){\n            event.stopPropagation();\n            this.close(null, 2);\n        }, this);\n    },\n\n    errorCallBack:function(){\n        if(this.showCallBack)\n        {\n            (this.showCallBack) && (this.showCallBack)(true);\n            this.showCallBack = null;\n        }\n    },\n\n    close: function(closeCallback, closeType){\n        if(!this.lock){\n            this.uiBlack.active = false;\n            let call3 = cc.callFunc(function()\n            {            \n                this.netData.helpShowFlag = false;\n                if(closeType == 2)\n                {\n                    if(window.aliLotteryCasinoSDK)\n                    {\n                        window.aliLotteryCasinoSDK.throwTimer('hideSheet', 'rule');\n                    }\n                    \n                }\n                else if(closeType ==1)\n                {\n                    closeCallback && closeCallback();\n                }\n            }, this);\n            \n            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.v2(0, this.oriY - this.scrollView.height)), call3));\n        }\n    },\n\n    downHelp: function(){\n        if(NetData.NetData.getInst().GameRule == null){\n            cc.log(\"GameRule is null \");\n            return;\n        }\n        var self = this;\n        let spt = this.gameNode.getComponent(Game);\n        let rh = 0;\n        var res = this.netData.GameRule.helpRule.rulePics;\n        cc.loader.load(res, null, function (errors, results) {\n            if (errors) {\n                for (var i = 0; i < errors.length; i++) {\n                    console.log('Error url [' + errors[i] + ']: ' + results.getError(errors[i]));\n                }\n            }\n            cc.log(\"results is %% \", results.getContent.length);\n            let len = self.netData.GameRule.helpRule.rulePics.length;\n            \n            for(let i = 0; i < len; i++){   \n                \n                var aTex = results.getContent(self.netData.GameRule.helpRule.rulePics[i]); \n                console.log(self.netData.GameRule.helpRule.rulePics[i] + \"|\" + aTex);\n                let sf = new cc.SpriteFrame();\n                sf.setTexture(aTex);\n                self.imgArray[i].node.active = true;\n                self.imgArray[i].spriteFrame = sf;\n                //\n                let width = self.imgArray[i].node.width;\n                let heightT = (1080 / width) * self.imgArray[i].node.height * self.scaleValue;\n                self.imgArray[i].node.width = 1080 * self.scaleValue;\n                self.imgArray[i].node.height = heightT;\n                //self.imgArray[i].node.setScale(1080 / width);\n                rh += heightT;\n                cc.log(\"height is $$$ \", self.imgArray[i].node.height);\n                //支持多张图排版（2017-03-27 pm：520）\n                if(i > 0){\n                    \n                    var index = i - 1;\n                    let ht = self.imgArray[index].node.height;\n                    self.imgArray[i].node.y  = self.imgArray[index].node.y - ht + 1;\n                    // cc.log(\"height is $$$ \", ht);\n                }\n            }\n\n            // if(len == 2){\n            //     let ht = self.imgArray[0].node.height;\n            //     self.imgArray[1].node.y = -ht;\n            // }\n            self.content.height = rh;\n            spt.hideWait();\n            self.initHelp();\n        });\n    },\n\n    initHelp:function() {\n        if(!this.lock){\n            console.log(\"initHelp\");\n            this.netData.helpShowFlag = true;\n            this.lock = true;\n            this.scrollView.getComponent(cc.ScrollView).scrollToOffset(cc.p(0,0), 0.1);\n            let callback = cc.callFunc(this.selectShowCallBack, this);\n            this.node.runAction(cc.sequence(cc.moveTo(0.3, cc.p(0, this.oriY)), callback));\n        }        \n    },\n\n    selectShowCallBack:function()\n    {\n        this.uiBlack.active = true;\n        this.lock = false;\n\n        if(this.showCallBack)\n        {\n            (this.showCallBack) && (this.showCallBack)();\n\n            this.showCallBack = null;\n        }\n    },\n\n});\n"]}