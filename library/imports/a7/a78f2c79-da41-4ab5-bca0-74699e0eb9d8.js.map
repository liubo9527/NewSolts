{"version":3,"sources":["../../../../../assets/Script/network/assets/Script/network/Init.js"],"names":["DataOper","require","NetData","SdkData","cc","Class","extends","Component","init","self","sdk","window","aliLotteryCasinoSDK","CC_JSB","document","addEventListener","e","data","accessToken","getInst","gameToken","f","fetch","isError","console","log","skin","skinConfig","mergeResources","analyseResouce","initLoading","runGame","showError","callback","initData","dataOper","getInit","cmd","res","msg"],"mappings":";;;;;;AAAA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,UAAUF,QAAQ,SAAR,CAAd;;AAIAG,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGL;;;;AAIAC,UAAM,gBAAW;AACb,YAAIC,OAAO,IAAX;AACA,YAAIC,MAAOC,OAAOC,mBAAlB;AACA,YAAI,CAACC,MAAD,IAAWH,GAAf,EAAoB;AAChBI,qBAASC,gBAAT,CAA0B,aAA1B,EAAyC,UAASC,CAAT,EAAY;AACjD,oBAAGA,KAAKA,EAAEC,IAAP,IAAeD,EAAEC,IAAF,CAAOC,WAAzB,EAAqC;AACjClB,6BAASA,QAAT,CAAkBmB,OAAlB,GAA4BC,SAA5B,GAAwCJ,EAAEC,IAAF,CAAOC,WAA/C;AACH;AACD,oBAAIG,IAAIL,CAAR,CAJiD,CAIvC;AACVP,qBAAKa,KAAL,CAAW,UAASC,OAAT,EAAkB;AACzBC,4BAAQC,GAAR,CAAYF,OAAZ;AACA,wBAAI,CAACA,OAAL,EAAc;AACR;AACF;AACA;AACArB,gCAAQA,OAAR,CAAgBiB,OAAhB,GAA0BO,IAA1B,GAAiCL,EAAEJ,IAAF,CAAOU,UAAxC;;AAEA;AACA;AACA;AACA;AACE;AACFjB,4BAAIkB,cAAJ,CAAmBlB,IAAImB,cAAJ,CAAmB;AAClC;AACA;AAFkC,yBAAnB,CAAnB;AAIE;AACFnB,4BAAIoB,WAAJ;AACE;AACFpB,4BAAIqB,OAAJ;AACH,qBAnBD,MAmBO;AACHrB,4BAAIsB,SAAJ;AACH;AACJ,iBAxBD;AAyBD,aA9BH,EA8BK,KA9BL;AA+BH,SAhCD,MAgCO,CAEN;AACJ,KA7CI;;AA+CLV,WAAO,eAASW,QAAT,EAAmB;AACtB7B,WAAGqB,GAAH,CAAO,OAAP;AACA,aAAKS,QAAL,GAAgB,EAAhB;AACA,YAAIzB,OAAO,IAAX;AACA,YAAI0B,WAAWnC,SAASA,QAAT,CAAkBmB,OAAlB,EAAf;AACAgB,iBAASC,OAAT,CAAiB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,GAAnB,EAAwB9B,IAAxB,EAA8B;AAC1C;AACD,gBAAIc,UAAU,KAAd;AACA,gBAAGe,OAAO,MAAV,EAAiB;AACbf,0BAAU,KAAV;AACH,aAFD,MAGK,IAAG,UAAUe,GAAb,EAAiB;AAClBf,0BAAU,KAAV;AACH,aAFI,MAGA,IAAGe,OAAO,CAAV,EAAY;AACbf,0BAAU,IAAV;AACH;AACDnB,eAAGqB,GAAH,CAAO,iBAAP;AACArB,eAAGqB,GAAH,CAAOY,GAAP,EAAYC,GAAZ,EAAiBC,GAAjB;AACA9B,iBAAKyB,QAAL,CAAcG,GAAd,GAAoBA,GAApB;AACA5B,iBAAKyB,QAAL,CAAcI,GAAd,GAAoBA,GAApB;AACA7B,iBAAKyB,QAAL,CAAcK,GAAd,GAAoBA,GAApB;AACAN,wBAAYA,SAASV,OAAT,CAAZ;AACH,SAlBD,EAkBG,IAlBH;AAmBH;AAvEI,CAAT","file":"Init.js","sourceRoot":"../../../../../assets/Script/network","sourcesContent":["var DataOper = require(\"DataOper\");\nvar NetData = require(\"NetData\");\nvar SdkData = require(\"SdkData\");\n\n\n\ncc.Class({\n    extends: cc.Component,\n\n    /*ctor: function() {\n        \n    },*/\n\n    init: function() {\n        var self = this;\n        var sdk  = window.aliLotteryCasinoSDK;\n        if (!CC_JSB && sdk) {\n            document.addEventListener('casino:init', function(e) {\n                if(e && e.data && e.data.accessToken){\n                    DataOper.DataOper.getInst().gameToken = e.data.accessToken;\n                }\n                var f = e;//\n                self.fetch(function(isError) {\n                    console.log(isError);\n                    if (!isError) {\n                          //皮肤\n                        // var skin = \"\";\n                        // var extend = \"\";\n                        NetData.NetData.getInst().skin = f.data.skinConfig;\n\n                        // if(initResult){\n                        //     skin = initResult.skin.skinUrl;\n                        //     extend = initResult.extend;\n                        // }\n                          // 合并资源\n                        sdk.mergeResources(sdk.analyseResouce({\n                            // skin: skin,\n                            // extra: extend\n                          }));   \n                          // 显示 loading\n                        sdk.initLoading();\n                          // 运行游戏\n                        sdk.runGame();\n                    } else {\n                        sdk.showError();\n                    }\n                });\n              }, false);\n        } else {\n            \n        }\n    },\n\n    fetch: function(callback) {\n        cc.log(\"fetch\");\n        this.initData = {};\n        var self = this;\n        var dataOper = DataOper.DataOper.getInst();\n        dataOper.getInit(function(cmd, res, msg, self) {\n             // 判断是否成功并存储初始化\n            var isError = false;\n            if(res == 100007){\n                isError = false;\n            }\n            else if(200019 == res){\n                isError = false;\n            }\n            else if(res != 0){\n                isError = true;\n            }\n            cc.log('fetch init data');\n            cc.log(cmd, res, msg);\n            self.initData.cmd = cmd;\n            self.initData.res = res;\n            self.initData.msg = msg;\n            callback && callback(isError);\n        }, this);\n    },\n});\n"]}