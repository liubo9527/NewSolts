{"version":3,"sources":["../../../../../assets/Script/network/assets/Script/network/DataOper.js"],"names":["CryptoJS","require","NetData","GameData","KeyValue","cc","Class","properties","key","value","CusMap","maps","default","type","serializable","set","s_key","toString","flag","i","length","keyValue","push","get","clear","splice","NetWork","send","requestId","requestHeaders","requestData","callfunc","xhr","loader","getXMLHttpRequest","CC_JSB","window","aliLotteryCasinoSDK","getHttpRequestObject","open","timeout","setRequestHeader","onload","onerror","ontimeout","DataOper","statics","g_DataOperInst","s_index","getInst","init","destoryInst","aesKey","headerCmd","headerSig","headerVer","headerToken","gameToken","callfuncs","callnode","callcmd","log","GetQueryString","console","name","reg","RegExp","r","location","search","substr","match","unescape","request","callFunc","self","AESEncryption","MD5","netWork","onHttpRequestCompleted","status","getResponseHeader","callNode","callCmd","cmd","parseInt","res","msg","decodeURIComponent","sig","body","responseText","t_sig","t_sig_str","String","sig_str","trim","parserServerData","stopSellingDesc","data","AESDecrypt","iNum1","netData","initData","InitData","parseInitData","BetResult","JSON","parse","RewardResult","GameListResult","PoolResult","GameRule","enc","Utf8","iv","srcs","encrypted","AES","encrypt","mode","ECB","decrypt","stringify","getInit","getBet","gameType","ticketNo","step","mulriple","lineNum","playTime","obj","Object","getReward","ticket_no","getGameList","getPool","getRule","module","exports"],"mappings":"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","file":"DataOper.js","sourceRoot":"../../../../../assets/Script/network","sourcesContent":["var CryptoJS = require(\"core\");\nrequire(\"aes\");\nvar NetData = require(\"NetData\");\nvar GameData = require(\"GameData\");\n\nvar KeyValue = cc.Class({\n    properties: {\n        key : \"\",\n        value : \"\"\n    }\n});\n\nvar CusMap = cc.Class({\n    properties:{\n        maps : {\n            default : [],\n            type : [KeyValue],\n            serializable: false\n        }\n    },\n    \n    set : function(key, value){\n        var s_key = key.toString();\n        var flag = false;\n        \n        for(var i = 0; i < this.maps.length; ++i){\n            if(this.maps[i].key === s_key){\n                flag = true;\n                this.maps[i].value = value;\n                break;\n            }\n        }\n        \n        if(flag === false){\n            var keyValue = new KeyValue();\n            keyValue.key = s_key;\n            keyValue.value = value;\n            this.maps.push(keyValue);\n        }\n    },\n    \n    get : function(key){\n        var s_key = key.toString();\n        \n        for(var i = 0; i < this.maps.length; ++i){\n            if(this.maps[i].key === s_key){\n                return this.maps[i].value;\n            }\n        }\n        \n        return null;\n    },\n    \n    clear : function(key){\n        for(var i = 0; i < this.maps.length; ++i){\n            if(this.maps[i].key == key){\n                this.maps.splice(i, 1);\n                break;\n            }\n        }\n    }\n});\n\nvar NetWork = cc.Class({\n    send : function(requestId, requestHeaders, requestData, callfunc){\n        var xhr = cc.loader.getXMLHttpRequest();\n\n        if (!CC_JSB){\n            if (window.aliLotteryCasinoSDK) {\n                xhr = window.aliLotteryCasinoSDK.getHttpRequestObject();\n            }\n        }\n        \n        //xhr.open(\"POST\", \"http://10.0.20.52:8080/gateway/process\"); //\n        //xhr.open(\"POST\", \"https://gateway-dev.uuzz.com:10010/gateway/process\"); //山东\n        xhr.open(\"POST\", \"http://211.151.5.131:14030/gateway/process\"); //王雷\n        xhr.timeout = 15000;//15s超时\n        \n        //设置请求头\n        for(let i = 0; i < requestHeaders.length; ++i){\n            xhr.setRequestHeader(requestHeaders[i].key, requestHeaders[i].value);\n        }\n        // var myDate = new Date();\n        // cc.log(\"****************:\"+ myDate.getTime());\n        xhr.send(requestData);\n    \n        xhr.onload = function () {\n            // var myDate = new Date();\n            // cc.log(\"********* onLoad:\"+myDate.getTime());\n            callfunc(requestId, xhr);\n        };\n\n        xhr.onerror = function(){\n            // var myDate = new Date();\n            // cc.log(\"******** onerror:\"+myDate.getTime());\n            callfunc(requestId, xhr);\n        };\n        \n        xhr.ontimeout = function(){\n            // var myDate = new Date();\n            // cc.log(\"****** ontimeout:\"+myDate.getTime());\n            callfunc(requestId, xhr);\n        };\n    }\n});\n\nvar DataOper = cc.Class({\n    \n    statics : {\n        g_DataOperInst : null,\n        s_index : 0,\n        \n        getInst:function(){\n            \n            if(DataOper.g_DataOperInst === null)\n            {\n                DataOper.g_DataOperInst = new DataOper();\n                DataOper.g_DataOperInst.init();\n            }\n            return DataOper.g_DataOperInst;\n            \n        },\n\n        destoryInst:function(){\n            \n            if(DataOper.g_DataOperInst !== null){\n                DataOper.g_DataOperInst = null;\n            }\n        }\n    },\n\n    properties : {\n        //请求data\n        requestData : \"\",\n        //请求id\n        requestId : 0,\n        //aes Key\n        aesKey : \"817fed95f9e16bed\",//秘钥，写死\n        \n        //****************请求头信息**********\n        //请求头数组\n        requestHeaders : {\n            default : [],\n            type : [KeyValue],\n            serializable: false\n        },\n        //命令号\n        headerCmd : 0, //初始化-100  投注-101  结算-103\n        //sig\n        headerSig : \"\",\n        //版本号\n        headerVer : \"1.0\",\n        //会话标识\n        headerToken : \"3709660283\",//\"3629752610\",//\"2054683715\",//\"3709187220\",//\"3706201779\", \"3706261041\", \"2054683715\" \"yptdaily06/taobao1234 -> 3709177590\" \"yptdaily09/taobao1234 -> 3709187220\"\n        //游戏渠道实例标识an\n        gameToken : \"88c8afd5a29d5e27e4066f1f9eda5102-12-1576-2999\",\n        //原始 39bfced3c7ad0f9965dc15c59775bcbb-12-1576-1226\n        //外卖 88c8afd5a29d5e27e4066f1f9eda5102-12-1576-2999\n        //金币 94a957854809bc56614c282849eefa60-12-1576-2776\n        //游戏标识\n        //headerGid : \"10010\"  //每个游戏在这里写死  同花顺-10000  小怪联盟-10001  旗开得胜-10002 奇幻宝石-10003 老虎机-10004 地产大亨-10005 埃及探宝-10009\n    },\n    \n    init : function(){\n        this.callfuncs = new CusMap();\n        this.callnode = new CusMap();\n        this.callcmd = new CusMap();\n        cc.log(\"jb=\" + CC_JSB);\n        \n        if (!CC_JSB){\n            this.gameToken = this.GetQueryString(\"accessToken\");\n            this.headerToken = this.GetQueryString(\"tok\");\n            if(this.gameToken == null){                \n                this.gameToken = \"39bfced3c7ad0f9965dc15c59775bcbb-12-1576-1226\";\n            }\n            if(this.headerToken == null){\n                this.headerToken = \"0\";\n            }\n        }\n        else{\n\n        }        \n\n        console.log(\"this.gameToken = \" + this.gameToken);\n        console.log(\"this.headerToken = \" + this.headerToken);\n    },\n\n    GetQueryString : function(name)\n    {\n        var reg = new RegExp(\"(^|&)\"+ name +\"=([^&]*)(&|$)\");\n        var r = window.location.search.substr(1).match(reg);\n        if(r!==null)return  unescape(r[2]); return null;\n    },\n    \n    setRequestHeader : function(){\n        this.requestHeaders = [];\n\n        var keyValue = new KeyValue();\n        keyValue.key = \"cmd\";\n        keyValue.value = this.headerCmd.toString();\n        this.requestHeaders.push(keyValue);\n        \n        keyValue = new KeyValue();\n        keyValue.key = \"Content-Type\";\n        keyValue.value = \"text/plain\";\n        this.requestHeaders.push(keyValue);\n        \n        /*keyValue = new KeyValue();\n        keyValue.key = \"cid\";\n        keyValue.value = this.headerCid.toString();\n        this.requestHeaders.push(keyValue);*/\n        \n        keyValue = new KeyValue();\n        keyValue.key = \"sig\";\n        keyValue.value = this.headerSig.toString();\n        this.requestHeaders.push(keyValue);\n        \n        keyValue = new KeyValue();\n        keyValue.key = \"ver\";\n        keyValue.value = this.headerVer.toString();\n        this.requestHeaders.push(keyValue);\n        \n        keyValue = new KeyValue();\n        keyValue.key = \"tok\";\n        keyValue.value = this.headerToken.toString();\n        this.requestHeaders.push(keyValue);\n\n        keyValue = new KeyValue();\n        keyValue.key = \"gameToken\";\n        keyValue.value = this.gameToken.toString();\n        this.requestHeaders.push(keyValue);\n        \n        /*keyValue = new KeyValue();\n        keyValue.key = \"gid\";\n        keyValue.value = this.headerGid.toString();\n        this.requestHeaders.push(keyValue);*/\n    },\n    \n    request : function(callFunc, self){\n        if(this.headerCmd != 104){\n            console.log(\"request-----------data = \" + this.requestData);\n        }\n        \n        this.callfuncs.set(DataOper.s_index, callFunc);\n        this.callnode.set(DataOper.s_index, self);\n        this.callcmd.set(DataOper.s_index, this.headerCmd);\n        //aes加密\n        this.requestData = this.AESEncryption(this.requestData, this.aesKey);\n        //Base64\n        //this.requestData = Base64.encode(this.requestData);\n        //gzip\n        //this.requestData = this.requestData;\n        //md5\n        this.headerSig = CryptoJS.MD5(this.requestData);\n        //请求头\n        this.setRequestHeader();\n        //send\n        var netWork = new NetWork();\n        netWork.send(DataOper.s_index, this.requestHeaders, this.requestData, this.onHttpRequestCompleted);\n        DataOper.s_index++;\n    },\n    \n    /**\n     * 联网回调\n     * @Param requestId 请求id\n     * @param status   联网状态\n     * @param responeData 响应data\n     */\n    onHttpRequestCompleted : function(requestId, xhr){\n        console.log(\"onHttpRequestCompleted.xhr.status=\" + xhr.status);\n\n        if(xhr.status === 0)\n        {\n            console.log(\"onHttpRequestCompleted.xhr.msg= \" + xhr.getResponseHeader(\"msg\"));\n        }\n        \n        var callFunc = DataOper.getInst().callfuncs.get(requestId);\n        var callNode = DataOper.getInst().callnode.get(requestId);\n        var callCmd = DataOper.getInst().callcmd.get(requestId);\n        \n        DataOper.getInst().callfuncs.clear(requestId);\n        DataOper.getInst().callnode.clear(requestId);\n        DataOper.getInst().callcmd.clear(requestId);\n\n        if((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304){\n            //取http头\n            //命令号\n            var cmd = xhr.getResponseHeader(\"cmd\");\n            cmd = parseInt(cmd);\n            //res\n            var res = xhr.getResponseHeader(\"res\");\n            //msg\n            var msg = xhr.getResponseHeader(\"msg\");\n            msg = decodeURIComponent(msg);\n            //sig\n            var sig = xhr.getResponseHeader(\"sig\");\n            if(res == 0){\n                //取body\n                var body = xhr.responseText;\n                //md5验证\n                var t_sig = CryptoJS.MD5(body);\n                let t_sig_str = new String(t_sig);\n                let sig_str = new String(sig);\n                t_sig_str = t_sig_str.trim();\n                sig_str = sig_str.trim();\n\n                if(t_sig_str == sig_str){\n                    DataOper.getInst().parserServerData(body, cmd);\n                    callFunc(cmd, res, msg, callNode);\n                }\n                else{\n                    callFunc(cmd, -1, \"加密验证错误\", callNode);\n                }\n            }else{\n                console.log(\"报错---res:\" + res + \"----msg:\" + msg);\n                //纯业务logic\n                if((cmd == 100) && (res == 100007 || res == 200019)){\n                    NetData.NetData.getInst().stopSellingDesc = msg;\n                }\n                callFunc(cmd, res, msg, callNode);\n            }\n\n            //var callFunc = DataOper.getInst().callfuncs.get(requestId);\n            //var callNode = DataOper.getInst().callnode.get(requestId);\n            //cc.log(\"abcde\");\n            //callFunc(cmd, res, msg, callNode);\n        }else{\n            //联网失败\n             console.log(\"http status:\" + xhr.status + \"|callCmd=\" + callCmd);\n            //callFunc(DataOper.getInst().headerCmd, -1, \"网络可能不好哦，请重试\", callNode);\n             callFunc(callCmd, -1, \"网络可能不好哦，请重试\", callNode);//服务器连续错误发过来的时候 2017-2-15\n        }\n    },\n    \n    /**\n     *解析服务器返回数据\n     * @param data\n     * @param cmd\n     */\n     parserServerData : function(data, cmd){\n         //gzip解压\n         //data = data;\n         //Base64\n         //data = Base64.decode(data);\n         //aes解密\n         data = this.AESDecrypt(data, this.aesKey);\n         var iNum1 = parseInt(cmd);\n\n         if(iNum1 != 104){\n             console.log(\"data = \" + data + \", cmd = \" + cmd);\n         }\n         \n         //console.log(\"data = \" + data + \", cmd = \" + cmd);\n         var netData = NetData.NetData.getInst();\n         switch(iNum1){\n             case 100:{//初始化协议\n                var initData=new GameData.InitData();\n                initData.parseInitData(data);\n             }\n             break;\n             case 101:{//投注协议\n                netData.BetResult = JSON.parse(data); \n             }\n             break;\n             case 102:{//结算协议\n                netData.RewardResult = JSON.parse(data);\n             }\n             break;\n\n             case 103:{//游戏订单列表\n                netData.GameListResult = JSON.parse(data).data;\n             }\n             break;\n\n             case 104:{//奖池\n                netData.PoolResult = JSON.parse(data);\n             }\n             break;\n             case 105:{//规则\n                netData.GameRule = JSON.parse(data);\n             }\n             break;\n             default:\n             break;\n         }\n     },\n     \n    //AES加密\n    AESEncryption : function (data, aesKey) {\n        //return CryptoJS.CryptoJS.AES.encrypt(data, aesKey).toString();\n        var key = CryptoJS.enc.Utf8.parse(aesKey);\n        var iv  = CryptoJS.enc.Utf8.parse(aesKey);\n        var srcs = CryptoJS.enc.Utf8.parse(data);\n        var encrypted = CryptoJS.AES.encrypt(srcs, key, { iv: iv,mode:CryptoJS.mode.ECB});\n        //var encodeStr = encodeURIComponent(encrypted.toString());\n        //var md5Str = CryptoJS.MD5(encodeStr);\n        return encrypted.toString();\n    },\n    \n    //AES解密\n    AESDecrypt : function (data, aesKey) {\n        //return CryptoJS.CryptoJS.AES.decrypt(data, aesKey).toString(CryptoJS.CryptoJS.enc.Utf8);\n        var key = CryptoJS.enc.Utf8.parse(aesKey);\n        var iv  = CryptoJS.enc.Utf8.parse(aesKey);\n        var decrypt = CryptoJS.AES.decrypt(data, key, { iv: iv,mode:CryptoJS.mode.ECB});\n        return CryptoJS.enc.Utf8.stringify(decrypt).toString();\n    },\n \n    /**\n     * 初始化\n     * @param\n     * \n     */\n    getInit : function(callFunc, self){\n        this.requestData = \"{}\";\n        //设置命令号，每个请求都不一样\n        this.headerCmd = 100;\n        //请求网络\n        this.request(callFunc, self);\n    },\n    \n    /**\n     * 投注\n     * @param gameType 游戏类型(0:普通游戏 1:免费游戏) int\n     * @param ticketNo 订单(票)号。\n     * @param step 当前免费游戏的次数。int\n     * @param mulriple 投注倍数。\n     * @param lineNum 投注线数。\n     * @param playTime 游戏时间。\n     */\n    getBet : function(gameType,ticketNo,step,mulriple,lineNum,playTime,callFunc, self){\n        this.requestData = \"\";\n        //拼成json串，每个请求都不一样\n        var obj = new Object();\n        obj.gameType = gameType;\n        obj.ticketNo = ticketNo;\n        obj.step = step;\n        obj.mulriple = mulriple;\n        obj.lineNum = lineNum;\n        obj.playTime = playTime;\n\n        this.requestData = JSON.stringify(obj); \n        obj = null;\n        //设置命令号，每个请求都不一样\n        this.headerCmd = 101;\n        //请求网络\n        this.request(callFunc, self);\n    },\n\n     \n    /**\n     * 结算\n     * @param ticket_no 订单号\n     * @param playTime 游戏时间\n     */\n    getReward : function(ticket_no, playTime,callFunc, self){\n        this.requestData = \"\";\n        //拼成json串，每个请求都不一样\n        var obj = new Object();\n        obj.ticketNo = ticket_no;\n        obj.playTime = playTime;\n        this.requestData = JSON.stringify(obj); \n        obj = null;\n        //设置命令号，每个请求都不一样\n        this.headerCmd = 102;\n        //请求网络\n        this.request(callFunc, self);\n    },\n\n    /**\n     * 获取游戏列表\n     */\n    getGameList:function (callFunc, self) {\n        this.requestData = \"{}\";\n         //设置命令号，每个请求都不一样\n        this.headerCmd = 103;\n        //请求网络\n        this.request(callFunc, self);\n    },\n\n   /**\n     * 获取奖池\n     */\n    getPool:function (callFunc, self) {\n        this.requestData = \"{}\";\n         //设置命令号，每个请求都不一样\n        this.headerCmd = 104;\n        //请求网络\n        this.request(callFunc, self);\n    },\n\n     /**\n     * 获取规则\n     */\n    getRule:function (callFunc, self) {\n        this.requestData = \"{}\";\n         //设置命令号，每个请求都不一样\n        this.headerCmd = 105;\n        //请求网络\n        this.request(callFunc, self);\n    }\n});    \n\nmodule.exports = {\n    DataOper : DataOper\n};"]}